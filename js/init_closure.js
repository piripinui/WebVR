var f="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)},m="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function p(){p=function(){};m.Symbol||(m.Symbol=t)}var u=0;function t(a){return"jscomp_symbol_"+(a||"")+u++}
function x(){p();var a=m.Symbol.iterator;a||(a=m.Symbol.iterator=m.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&f(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return y(this)}});x=function(){}}function y(a){var c=0;return z(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})}function z(a){x();a={next:a};a[m.Symbol.iterator]=function(){return this};return a}
function A(a,c){x();a instanceof String&&(a+="");var b=0,e={next:function(){if(b<a.length){var g=b++;return{value:c(g,a[g]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}for(var B=m,C=["Array","prototype","values"],H=0;H<C.length-1;H++){var I=C[H];I in B||(B[I]={});B=B[I]}var J=C[C.length-1],K=B[J],P=K?K:function(){return A(this,function(a,c){return c})};P!=K&&null!=P&&f(B,J,{configurable:!0,writable:!0,value:P});
var Q,R={B:new Cesium.Cartesian3(-1272209.292469148,-4751630.941108344,4063428.939909443),N:new Cesium.Cartesian3(-1289792.3587257643,-4746245.525598164,4051013.2689858945),controller:Cesium.Cartesian3.fromDegrees(-75.62898254394531,40.02804946899414,0),D:Cesium.Cartesian3.fromDegrees(-104.992089,39.761292,1E4),F:Cesium.Cartesian3.fromDegrees(-104.992089,39.761292,2500),C:Cesium.Cartesian3.fromDegrees(-104.999471,39.749217,1800)},S=[];
function T(a){var c=Q.terrainProvider,b=[Cesium.Cartographic.j(R[a])],c=Cesium.R(c,11,b);Cesium.T(c,function(){Q.scene.camera.flyTo({destination:R[a],orientation:{pitch:0}})})}
function init(){function a(a){return 180/Math.PI*a}function c(a){for(a+="";6>a.length;)a="0"+a;return a}function b(){console.log("Flying back to home position...");D.m()}var e=new Cesium.MapboxImageryProvider({mapId:"mapbox.streets"});new Cesium.BingMapsImageryProvider({url:"//dev.virtualearth.net",mapStyle:Cesium.BingMapsStyle.AERIAL_WITH_LABELS});Q=new Cesium.Viewer("cesiumContainer",{vrButton:!0,baseLayerPicker:!1,imageryProvider:e,scene3DOnly:!0});Q.terrainProvider=new Cesium.CesiumTerrainProvider({url:"https://assets.agi.com/stk-terrain/world",
requestVertexNormals:!0});Q.scene.globe.depthTestAgainstTerrain=!0;Q.scene.globe.I=!0;Q.scene.L=!1;Cesium.GeoJsonDataSource.load("data/denver_small.json").then(function(a){Q.dataSources.add(a);a=a.entities.values;var c=new Cesium.Color(.8,.8,.8,1);console.log("Processing "+a.length+" entities...");for(var g=0;g<a.length;g++){var b=a[g];b.polygon.material=c;b.polygon.outline=!1;b.polygon.height=b._properties.BASEELEV_M-20;b.polygon.extrudedHeight=b._properties.TOPELEV_M-20}console.log("Finished loading buildings...")});
var g=document.createElement("span");g.style.position="absolute";g.style.top="10px";g.style.left="10px";g.style.color="white";g.style["font-family"]="Courier New";g.style["z-index"]="999";g.textContent="Debug";Q.container.appendChild(g);var D=Q.scene.camera,N,v,w;(function(){function e(a){a={alpha:!1,preserveDrawingBuffer:a};k=l.getContext("webgl",a);if(!k&&(k=l.getContext("experimental-webgl",a),!k)){VRSamplesUtil.addError("Your browser does not support WebGL.");return}k.clearColor(.1,.2,.3,1);k.enable(k.DEPTH_TEST);
k.enable(k.CULL_FACE);new WGLUStats(k);window.addEventListener("resize",F,!1);F();window.requestAnimationFrame(G)}function L(){for(var O=navigator.getGamepads(),c=0;c<O.length;c++){var d=O[c];if(d&&"OpenVR Gamepad"==d.id&&d.a){if(d.a.position){var b=D.positionCartographic,b=Cesium.Cartesian3.fromDegrees(a(b.longitude),a(b.latitude),b.height-10),b=Cesium.Transforms.eastNorthUpToFixedFrame(b);N||(console.log("Loading the Vive controller model..."),N=Q.scene.primitives.add(Cesium.s.K({url:"models/Vive_Controller_Body.glb",
modelMatrix:b,scale:1})))}S.push(d)}}}function E(){var a=d.f("left"),c=d.f("right"),b=a.i+c.i,a=a.h+c.h;D.m();console.log("HDM is displaying "+b+" pixels wide and "+a+" pixels high.");b=b/a*window.outerHeight;console.log("Resizing window...");window.resizeTo(b,window.outerHeight);d.O([{source:l}]).then(function(){L()},function(){VRSamplesUtil.addError("requestPresent failed.",2E3)})}function M(){d.g&&d.J().then(function(){},function(){VRSamplesUtil.addError("exitPresent failed.",2E3)})}function U(){F();
d.g?d.c.l&&(VRSamplesUtil.o(n),n=VRSamplesUtil.b("Exit VR","E","media/icons/cardboard64.png","vricon",M)):d.c.l&&(VRSamplesUtil.o(n),n=VRSamplesUtil.b("Enter VR","E","media/icons/cardboard64.png","vricon",E))}function F(){if(d&&d.g){var a=d.f("left"),c=d.f("right");l.width=2*Math.max(a.i,c.i);l.height=Math.max(a.h,c.h)}else l.width=l.offsetWidth*window.devicePixelRatio,l.height=l.offsetHeight*window.devicePixelRatio}function G(){k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);if(d)if(d.requestAnimationFrame(G),
d.M(h),d.g){var b=Q.scene.camera;if(h.a&&h.a.orientation){var e=function(a){var b;-.5>=h.a.orientation[a]&&-1<=h.a.orientation[a]&&(b=Math.PI/2-h.a.orientation[a]*Math.PI);.5<h.a.orientation[a]&&1>=h.a.orientation[a]&&(b=2.5*Math.PI-h.a.orientation[a]*Math.PI);0<h.a.orientation[a]&&.5>=h.a.orientation[a]&&(b=Math.PI/2-h.a.orientation[a]*Math.PI);0>h.a.orientation[a]&&-.5<=h.a.orientation[a]&&(b=Math.PI/2-h.a.orientation[a]*Math.PI);return b},q=e(0),r=e(1),e=e(2)-Math.PI/2;0>e&&(e=2*Math.PI+e);v||
(v=r);w||(w=q);if(!isNaN(r)&&!isNaN(q)&&!isNaN(e)){var n=q-w;b.lookRight(r-v);b.lookDown(n);b.setView({orientation:{heading:r,pitch:Math.PI/2-q,roll:e}});w=q;v=r;g.textContent="HMD Heading = "+c(a(r).toFixed(2))+", Camera heading= "+c(a(b.heading).toFixed(2))+", HMD pitch = "+c(a(q).toFixed(2))+", Camera pitch = "+c(a(b.pitch).toFixed(2))+", HMD roll = "+c(a(e).toFixed(2))+", Camera roll = "+c(a(b.roll).toFixed(2))}}S=[];L();Q.render();d.S()}else b=Q.scene.camera,k.viewport(0,0,l.width,l.height),
g.textContent="Camera heading = "+c(a(b.heading).toFixed(2))+", Camera pitch = "+c(a(b.pitch).toFixed(2))+", Camera roll = "+c(a(b.roll).toFixed(2)),Q.render();else window.requestAnimationFrame(G),k.viewport(0,0,l.width,l.height),Q.render()}var d=null,h=null,n=null,l=Q.canvas,k=null;navigator.j?(h=new VRFrameData,navigator.j().then(function(a){0<a.length?(d=a[0],d.H=.1,d.G=1024,VRSamplesUtil.b("Fly to Home","F",null,null,b),VRSamplesUtil.b("Fly to Redrocks","D",null,null,function(){T("redrocks")}),
VRSamplesUtil.b("Fly to Denver Downtown","S",null,null,function(){T("denver_downtown_tight")}),VRSamplesUtil.b("Denver Downtown 3D Buildings","A",null,null,function(){T("denver_3d_buildings")}),VRSamplesUtil.b("Reset Pose","R",null,null,function(){d.P()}),d.c.A&&(n=VRSamplesUtil.b("Enter VR","E","media/icons/cardboard64.png","vricon",E)),window.addEventListener("vrdisplaypresentchange",U,!1),window.addEventListener("vrdisplayactivate",E,!1),window.addEventListener("vrdisplaydeactivate",M,!1),e(d.c.l)):
(e(!1),VRSamplesUtil.u("WebVR supported, but no VRDisplays found.",3E3))})):navigator.v?(e(!1),VRSamplesUtil.addError("Your browser supports WebVR but not the latest version. See <a href='http://webvr.info'>webvr.info</a> for more info.")):(e(!1),VRSamplesUtil.addError("Your browser does not support WebVR. See <a href='http://webvr.info'>webvr.info</a> for assistance."))})()}window.init=init;window.flytoLocation=T;window.gotoLocation=function(a){Q.scene.camera.position=R[a]};
